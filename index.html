
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>作文问题测试</title>
    <!-- 引入 Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 引入 React, ReactDOM 和 Babel (用于在线解析 JSX) -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700;900&display=swap');
        body {
            font-family: 'Noto+Sans+SC', sans-serif;
            background-color: #f8fafc;
            user-select: none;
        }
        .option-button:active { transform: scale(0.98); }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in { animation: fadeIn 0.4s ease-out forwards; }
    </style>
<script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@^19.2.3",
    "react-dom/": "https://esm.sh/react-dom@^19.2.3/",
    "react/": "https://esm.sh/react@^19.2.3/"
  }
}
</script>
<link rel="stylesheet" href="/index.css">
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useCallback, useRef, useEffect } = React;

        // --- 数据常量 ---
        const QUESTIONS = [
            { id: 1, text: "假如给你一盒新乐高，你会怎么拼？", options: [{ text: "脑子里马上就有画面，马上就开始拼了。", score: 1 }, { text: "拿着积木比划半天，不知道从哪块开始。", score: 2 }, { text: "盯着说明书发呆，半天都没动手。", score: 3 }, { text: "觉得太难了，不想拼，想直接放弃。", score: 4 }] },
            { id: 2, text: "刚开始写周末作业的时候，你的状态通常是？", options: [{ text: "很快进入状态，第一行字马上就写完了。", score: 1 }, { text: "写了擦，擦了写，总觉得第一行写得不好看。", score: 2 }, { text: "玩橡皮、喝喝水，很难坐得住。", score: 3 }, { text: "一直喊“妈，这道题怎么做”，没人催就不动笔。", score: 4 }] },
            { id: 3, text: "如果你给好朋友讲一个笑话，你会讲多久？", options: [{ text: "讲得很详细，越讲越起劲，讲很久。", score: 1 }, { text: "正常长度，把笑话讲完就行。", score: 2 }, { text: "三言两语就讲完了，没什么可说的。", score: 3 }, { text: "就一两句话，根本不算个笑话。", score: 4 }] },
            { id: 4, text: "给别人介绍你最喜欢的动画片，你通常是？", options: [{ text: "讲得特别精彩，别人都听得入迷了。", score: 1 }, { text: "能把故事讲清楚，但没什么表情。", score: 2 }, { text: "像报菜名一样，把谁赢了说一遍。", score: 3 }, { text: "讲了半天，别人还是不知道那动画片演什么的。", score: 4 }] },
            { id: 5, text: "告诉妈妈今天学校发生的趣事，你的说法是？", options: [{ text: "挑一两件最好玩的事讲，其他的都不说。", score: 1 }, { text: "东一句西一句，有时候说着说着就跑题了。", score: 2 }, { text: "从早上睁开眼讲到放学，像记流水账。", score: 3 }, { text: "每句话前面都要加个“然后”。", score: 4 }] },
            { id: 6, text: "像在球赛里进球了，你会怎么描述那个时刻？", options: [{ text: "会细细描述怎么跑、怎么踢、大家怎么欢呼。", score: 1 }, { text: "就说一句“我进球了”，跟平时说话一样。", score: 2 }, { text: "还没反应过来呢，那个瞬间就过去了。", score: 3 }, { text: "没什么特别的，跟踢空门一样没感觉。", score: 4 }] },
            { id: 7, text: "如果让你画一张“下雨天”的画，你的画通常是？", options: [{ text: "画得很有感觉，能感觉到风很大。", score: 1 }, { text: "画得比较仔细，雨丝都能数清楚。", score: 2 }, { text: "只有几条黑线，表示这里有雨。", score: 3 }, { text: "只是简单涂黑了一块，表示天阴了。", score: 4 }] },
            { id: 8, text: "讲一件让你特别生气的事，你的表现是？", options: [{ text: "眉毛都竖起来了，手舞足蹈，特别有情绪。", score: 1 }, { text: "能说出来自己很生气，但表情还好。", score: 2 }, { text: "像背课文一样，平平地说“我很生气”。", score: 3 }, { text: "只说事情经过，不说心里怎么想的。", score: 4 }] },
            { id: 9, text: "收拾书包或整理房间时，你的习惯是？", options: [{ text: "会分类整理，重的放下面，轻的放上面。", score: 1 }, { text: "大概分一下，书本和玩具分开就行。", score: 2 }, { text: "哪里有空塞哪里，经常乱糟糟的。", score: 3 }, { text: "想到什么放什么，没有规律。", score: 4 }] },
            { id: 10, text: "就像搭积木塔，你的结尾通常是？", options: [{ text: "盖上漂亮的屋顶，跟底座很配。", score: 1 }, { text: "随便拿一块积木放上面封顶。", score: 2 }, { text: "搭到一半不想搭了，或者摇摇晃晃就结束了。", score: 3 }, { text: "发现搭错了，或者不知道怎么收尾。", score: 4 }] },
            { id: 11, text: "画完一幅画之后，你会？", options: [{ text: "再仔细看看，哪里不好看再改改。", score: 1 }, { text: "大概看一眼，有没有画到桌子外面去。", score: 2 }, { text: "最后一笔刚落下，画笔就扔了，不想再看。", score: 3 }, { text: "谁说画得不好，我就跟谁急。", score: 4 }] },
            { id: 12, text: "如果你拼错了一块乐高，被人指出来，你会？", options: [{ text: "马上拆掉重拼，谢谢他提醒。", score: 1 }, { text: "看一眼，如果真的很明显就改改。", score: 2 }, { text: "觉得没拼错，不想改。", score: 3 }, { text: "会很生气，不想拼了。", score: 4 }] },
            { id: 13, text: "老师让你讲个故事，你会讲什么？", options: [{ text: "讲我自己亲身经历的真事。", score: 1 }, { text: "讲我听别人说过的故事，稍微变一下。", score: 2 }, { text: "觉得真事没意思，全靠瞎编。", score: 3 }, { text: "直接把书上的故事背一遍。", score: 4 }] },
            { id: 14, text: "如果你要告诉别人一个道理，你会怎么说？", options: [{ text: "讲我自己经历的故事，别人自然就懂了。", score: 1 }, { text: "先讲事情，最后加一句“我明白了……”", score: 2 }, { text: "直接喊口号，比如“我们要努力学习”。", score: 3 }, { text: "讲着讲着就忘了主题了。", score: 4 }] },
            { id: 15, text: "看看你的书桌或者抽屉，通常是？", options: [{ text: "很整齐，像新的一样。", score: 1 }, { text: "有一点乱，但找东西还能找到。", score: 2 }, { text: "字写得很乱，卷面黑乎乎的。", score: 3 }, { text: "皱皱巴巴，还有墨水团，很脏。", score: 4 }] },
            { id: 16, text: "就像平时说话停顿一样，你的习惯是？", options: [{ text: "说得很清楚，该停顿就停顿。", score: 1 }, { text: "偶尔会打结，但还算通顺。", score: 2 }, { text: "说话不换气，连成一串。", score: 3 }, { text: "经常说错话，或者让人听不懂。", score: 4 }] },
            { id: 17, text: "如果你要给妈妈拍一张照片，你会怎么拍？", options: [{ text: "拍妈妈正在做事的样子，很有趣。", score: 1 }, { text: "拍一张大头照，拍得很大。", score: 2 }, { text: "像拍证件照一样，从头拍到脚。", score: 3 }, { text: "拍得很模糊，或者看不清是谁。", score: 4 }] },
            { id: 18, text: "如果让你画一张学校的画，你会怎么画？", options: [{ text: "画小朋友在玩耍，还有花花草草。", score: 1 }, { text: "把教学楼和旗台画清楚。", score: 2 }, { text: "只涂颜色，红的红绿的绿，没有具体的样子。", score: 3 }, { text: "随便画几根线条，看不出来是学校。", score: 4 }] },
            { id: 19, text: "想象一下“未来的汽车”，你觉得它会是？", options: [{ text: "看起来很酷，但真的能造出来。", score: 1 }, { text: "可以在水里开，可以在天上飞。", score: 2 }, { text: "像魔法车一样，想变什么就变什么。", score: 3 }, { text: "跟现在的校车没什么区别。", score: 4 }] },
            { id: 20, text: "看完一部好电影，你会怎么推荐给别人？", options: [{ text: "重点讲我看电影时的感受和想法。", score: 1 }, { text: "一半讲电影内容，一半讲我的感受。", score: 2 }, { text: "主要是把电影里的故事复述一遍。", score: 3 }, { text: "只能说出电影的名字和主角是谁。", score: 4 }] }
        ];

        const DIMENSIONS = {
            A: { name: '启动困难', meaning: '指开始写作文时非常吃力，不知道第一句话该怎么写，迟迟无法动笔。', indices: [0, 1], count: 2 },
            B: { name: '内容贫乏', meaning: '指文章内容空洞，写出来的东西很少，像压缩饼干一样干瘪，无法展开细节。', indices: [2, 3], count: 2 },
            C: { name: '流水账作文', meaning: '指像记账一样，把所有事情按顺序罗列出来，没有突出重点或细节。', indices: [4, 5], count: 2 },
            D: { name: '语言平淡', meaning: '指文章语言干巴巴，像白开水一样寡淡，缺乏好词好句和修辞手法。', indices: [6, 7], count: 2 },
            E: { name: '结构混乱', meaning: '指文章缺乏条理，东一句西一句，逻辑不清，段落划分也不合理。', indices: [8, 9], count: 2 },
            F: { name: '抗拒修改', meaning: '指写完初稿后不愿意检查、朗读或修改，对他人的修改意见有抵触情绪。', indices: [10, 11], count: 2 },
            G: { name: '内容思想', meaning: '指文章选材虚假（瞎编）或陈旧（老套），中心思想像喊口号，缺乏真实的感悟。', indices: [12, 13], count: 2 },
            H: { name: '技术问题', meaning: '指基础书写能力较弱，错别字多，标点符号使用混乱，卷面不整洁。', indices: [14, 15], count: 2 },
            I: { name: '特定文体', meaning: '指不掌握特定文体（如写人、写景、读后感）的写作方法，用错误的套路去写。', indices: [16, 17, 18, 19], count: 4 }
        };

        // --- 组件 ---

        const QuestionCard = ({ question, currentIndex, totalQuestions, onSelect, onPrev, onNext, selectedAnswer, onProgressClick }) => {
            const progress = ((currentIndex + 1) / totalQuestions) * 100;
            return (
                <div className="w-full max-w-xl mx-auto p-4 md:p-6 animate-fade-in">
                    <div className="mb-8 select-none">
                        <div className="flex justify-between items-center mb-2">
                            <span onClick={onProgressClick} className="text-sm font-medium text-slate-500 cursor-default active:text-blue-400">进度</span>
                            <span className="text-sm font-bold text-blue-600">{currentIndex + 1} / {totalQuestions}</span>
                        </div>
                        <div className="w-full bg-slate-200 h-2 rounded-full overflow-hidden">
                            <div className="bg-blue-600 h-full transition-all duration-300" style={{ width: `${progress}%` }}></div>
                        </div>
                    </div>
                    <div className="bg-white rounded-2xl shadow-lg p-8 mb-6 border border-slate-100">
                        <h2 className="text-xl md:text-2xl font-bold text-slate-800">{question.text}</h2>
                    </div>
                    <div className="space-y-4 mb-8">
                        {question.options.map((option, idx) => (
                            <button key={idx} onClick={() => onSelect(option.score)} className={`w-full text-left bg-white border-2 p-5 rounded-xl transition-all group flex items-start gap-4 ${selectedAnswer === option.score ? 'border-blue-600 bg-blue-50' : 'border-slate-100 hover:border-blue-200'}`}>
                                <span className={`w-8 h-8 rounded-full flex items-center justify-center font-bold ${selectedAnswer === option.score ? 'bg-blue-600 text-white' : 'bg-slate-100 text-slate-500'}`}>{String.fromCharCode(65 + idx)}</span>
                                <span className="flex-1 font-medium pt-1 text-slate-700">{option.text}</span>
                            </button>
                        ))}
                    </div>
                    <div className="flex gap-4">
                        <button onClick={onPrev} disabled={currentIndex === 0} className="flex-1 py-4 rounded-xl bg-white border border-slate-200 font-bold text-slate-500 disabled:opacity-30">上一题</button>
                        <button onClick={onNext} disabled={!selectedAnswer} className="flex-1 py-4 rounded-xl bg-blue-600 text-white font-bold disabled:bg-slate-200">下一题</button>
                    </div>
                </div>
            );
        };

        const ResultPage = ({ result, onReset }) => (
            <div className="w-full max-w-xl mx-auto p-6 flex flex-col items-center justify-center min-h-[80vh] animate-fade-in">
                <div className="text-center mb-10">
                    <div className="w-20 h-20 bg-blue-600 rounded-full flex items-center justify-center mx-auto mb-4 shadow-xl shadow-blue-200">
                        <svg className="w-10 h-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="3" d="M5 13l4 4L19 7" /></svg>
                    </div>
                    <h1 className="text-3xl font-black text-slate-800">测试报告</h1>
                </div>
                <div className="w-full space-y-6">
                    <div className="bg-white rounded-3xl p-8 shadow-xl border-t-8 border-blue-600">
                        <span className="text-blue-600 font-bold text-xs uppercase tracking-widest">核心问题</span>
                        <h2 className="text-2xl font-black text-slate-800 mt-1">{result.primary.name}</h2>
                        <p className="text-sm text-slate-500 mt-2 italic">{result.primary.meaning}</p>
                    </div>
                    <div className="bg-white rounded-3xl p-8 shadow-xl border-t-8 border-slate-300">
                        <span className="text-slate-500 font-bold text-xs uppercase tracking-widest">次要问题</span>
                        <h2 className="text-2xl font-black text-slate-800 mt-1">{result.secondary.name}</h2>
                        <p className="text-sm text-slate-500 mt-2 italic">{result.secondary.meaning}</p>
                    </div>
                </div>
                <button onClick={onReset} className="mt-12 px-10 py-4 bg-slate-800 text-white rounded-full font-bold">重新测试</button>
            </div>
        );

        // --- 主应用 ---

        const App = () => {
            const [currentIndex, setCurrentIndex] = useState(0);
            const [userAnswers, setUserAnswers] = useState([]);
            const [isFinished, setIsFinished] = useState(false);
            const [diagnosticResult, setDiagnosticResult] = useState(null);
            const debugClickCount = useRef(0);

            const process = (ans) => {
                const res = Object.keys(DIMENSIONS).map(k => {
                    const d = DIMENSIONS[k];
                    const sum = d.indices.reduce((s, i) => s + (ans[i] || 1), 0);
                    return { name: d.name, meaning: d.meaning, avgScore: sum / d.count };
                }).sort((a, b) => b.avgScore - a.avgScore);
                return { primary: res[0], secondary: res[1] };
            };

            const handleSelect = (s) => {
                const newAns = [...userAnswers]; newAns[currentIndex] = s;
                setUserAnswers(newAns);
                if (currentIndex < QUESTIONS.length - 1) setTimeout(() => setCurrentIndex(prev => prev + 1), 300);
                else { setDiagnosticResult(process(newAns)); setIsFinished(true); }
            };

            const handleQuickFinish = () => {
                const finalAnswers = [...userAnswers];
                QUESTIONS.forEach((_, idx) => {
                    if (finalAnswers[idx] === undefined) {
                        finalAnswers[idx] = Math.floor(Math.random() * 4) + 1;
                    }
                });
                setUserAnswers(finalAnswers);
                setDiagnosticResult(process(finalAnswers));
                setIsFinished(true);
            };

            const handleDebugTrigger = () => {
                debugClickCount.current += 1;
                if (debugClickCount.current >= 5) {
                    handleQuickFinish();
                }
            };

            return (
                <div className="min-h-screen bg-slate-50">
                    {!isFinished ? (
                        <QuestionCard 
                            question={QUESTIONS[currentIndex]} 
                            currentIndex={currentIndex} 
                            totalQuestions={QUESTIONS.length} 
                            onSelect={handleSelect}
                            onPrev={() => currentIndex > 0 && setCurrentIndex(currentIndex - 1)}
                            onNext={() => currentIndex + 1}
                            selectedAnswer={userAnswers[currentIndex]}
                            onProgressClick={handleDebugTrigger}
                        />
                    ) : (
                        <ResultPage result={diagnosticResult} onReset={() => {setCurrentIndex(0); setUserAnswers([]); setIsFinished(false); debugClickCount.current = 0;}} />
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
<script type="module" src="/index.tsx"></script>
</body>
</html>
